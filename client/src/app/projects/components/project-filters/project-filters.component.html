<form [formGroup]="filtersForm" class="filters">
  <mat-form-field class="search-bar">
    <mat-icon matPrefix>search</mat-icon>
    <input matInput placeholder="Search Projects" formControlName="search">
    <button mat-button matSuffix mat-icon-button aria-label="Clear" (click)="onClearSearch()">
      <mat-icon>close</mat-icon>
    </button>
  </mat-form-field>

  <mat-form-field>
    <mat-select placeholder="Search Type"
                class="search-type"
                formControlName="searchType">
      <mat-option value="AllKeywords">All Keywords</mat-option>
      <mat-option value="AnyKeyword">Any Keyword</mat-option>
      <mat-option value="ExactMatch">Exact Match</mat-option>
    </mat-select>
  </mat-form-field>

  <ng-container *ngIf="isExpanded">
    <mat-form-field>
      <mat-select placeholder="Status" formControlName="wranglingState">
        <mat-option>None</mat-option>
        <mat-option *ngFor="let state of wranglingStates" [value]="transformWranglingState(state)">{{state}}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <mat-select placeholder="Wrangler" formControlName="primaryWrangler">
        <mat-option>None</mat-option>
        <mat-option *ngFor="let wrangler of wranglers$ | async" [value]="wrangler.id">{{wrangler.name}}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <mat-select placeholder="Priority" formControlName="wranglingPriority">
        <mat-option>None</mat-option>
        <mat-option *ngFor="let priority of [1,2,3]" [value]="priority">{{priority}}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <mat-select placeholder="HCA Publication" formControlName="hasOfficialHcaPublication">
        <mat-option>None</mat-option>
        <mat-option [value]="true">Yes</mat-option>
        <mat-option [value]="false">No</mat-option>
      </mat-select>
    </mat-form-field>

    <div class="cell-count">
      <p class="heading">Cell Count</p>

      <div class="cell-count__slider cell-count__slider--min">
        <mat-slider
          formControlName="minCellCount"
          min="0"
          [max]="filtersForm.get('maxCellCount').value"
          thumbLabel
          [displayWith]="formatLabel">
        </mat-slider>
        <small class="slider__label">Min.</small>
      </div>
      <div class="cell-count__slider cell-count__slider--max">
        <mat-slider
          formControlName="maxCellCount"
          min="0"
          [max]="maxCellCount"
          thumbLabel
          [displayWith]="formatLabel">
        </mat-slider>
        <small class="slider__label">Max.</small>
      </div>
    </div>

    <mat-form-field>
      <mat-select placeholder="Species" formControlName="identifyingOrganism">
        <mat-option>None</mat-option>
        <mat-option value="Human">Human</mat-option>
        <mat-option value="Mouse">Mouse</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <mat-label>Organ</mat-label>
      <!--Organ search input-->
      <input type="text"
             placeholder="Organ"
             matInput
             [(ngModel)]="organSearchValue"
             (ngModelChange)="organSearchChange($event)"
             [ngModelOptions]="{standalone: true}"
             [matAutocomplete]="auto">
      <!--Organ autocomplete dropdown-->
      <mat-autocomplete #auto="matAutocomplete" (optionSelected)="onOrganSelected($event)">
        <mat-option *ngFor="let organ of organs" [value]="organ">
          {{formatOrgan(organ)}}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>
  </ng-container>
</form>

<a class="vf-link" style="float: right; margin: 1rem 0;" href="javascript:void(0)" (click)="toggleFilters()">{{isExpanded ? 'Hide' : 'Show'}} filters</a>
